<!doctype html>
<html lang="vi">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Pandora's Box</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Crimson+Text:wght@400;600&display=swap');
        
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Crimson Text', serif;
            background: linear-gradient(135deg, #0F0F23 0%, #1A1A3A 50%, #0F0F23 100%);
            color: #F5F5F5;
            min-height: 100%;
            position: relative;
            overflow-x: hidden;
        }

        html {
            height: 100%;
        }

        /* Enhanced mystical background effects */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(75, 0, 130, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(184, 134, 11, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(0, 255, 255, 0.1) 0%, transparent 70%);
            pointer-events: none;
            z-index: -1;
        }

        /* Vignette effect */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, transparent 30%, rgba(0, 0, 0, 0.4) 70%, rgba(0, 0, 0, 0.8) 100%);
            pointer-events: none;
            z-index: -1;
        }

        /* Animated fog/smoke effect */
        .fog-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 120%;
            height: 120%;
            background: 
                radial-gradient(circle at 10% 20%, rgba(75, 0, 130, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(184, 134, 11, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 50% 10%, rgba(0, 255, 255, 0.05) 0%, transparent 60%);
            animation: fogDrift 20s ease-in-out infinite alternate;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes fogDrift {
            0% { transform: translate(-10px, -10px) rotate(0deg); }
            100% { transform: translate(10px, 10px) rotate(1deg); }
        }

        /* Floating particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: #FFD700;
            border-radius: 50%;
            box-shadow: 0 0 6px #FFD700;
            animation: float 15s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) translateX(0px) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-10vh) translateX(100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Rune decorations in corners */
        .rune-decoration {
            position: fixed;
            font-size: 2rem;
            color: rgba(184, 134, 11, 0.3);
            text-shadow: 0 0 10px rgba(184, 134, 11, 0.5);
            pointer-events: none;
            z-index: 1;
            animation: runeGlow 4s ease-in-out infinite alternate;
        }

        @keyframes runeGlow {
            0% { opacity: 0.3; text-shadow: 0 0 10px rgba(184, 134, 11, 0.5); }
            100% { opacity: 0.7; text-shadow: 0 0 20px rgba(184, 134, 11, 0.8); }
        }

        .rune-top-left { top: 20px; left: 20px; }
        .rune-top-right { top: 20px; right: 20px; }
        .rune-bottom-left { bottom: 20px; left: 20px; }
        .rune-bottom-right { bottom: 20px; right: 20px; }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Screen transitions */
        .screen {
            display: none;
            min-height: 100vh;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            text-align: center;
            padding: 40px 20px;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .screen.active {
            display: flex;
            opacity: 1;
        }

        .screen.fade-out {
            opacity: 0;
        }

        /* Content load-in animations */
        .fade-in-content {
            opacity: 0;
            transform: translateY(20px);
            animation: contentFadeIn 0.8s ease-out forwards;
        }

        .fade-in-content.delay-1 { animation-delay: 0.3s; }
        .fade-in-content.delay-2 { animation-delay: 0.6s; }
        .fade-in-content.delay-3 { animation-delay: 0.9s; }

        @keyframes contentFadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .pandora-box {
            width: 200px;
            height: 150px;
            margin: 30px auto;
            position: relative;
            animation: mysticalGlow 3s ease-in-out infinite alternate;
        }

        @keyframes mysticalGlow {
            0% { filter: drop-shadow(0 0 20px rgba(0, 255, 255, 0.5)); }
            100% { filter: drop-shadow(0 0 40px rgba(184, 134, 11, 0.8)); }
        }

        /* Enhanced box with escaping light */
        .box-light-rays {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #FFD700, transparent);
            transform: translate(-50%, -50%);
            animation: lightRays 4s ease-in-out infinite;
        }

        @keyframes lightRays {
            0%, 100% { opacity: 0; transform: translate(-50%, -50%) rotate(0deg) scaleX(0); }
            50% { opacity: 1; transform: translate(-50%, -50%) rotate(180deg) scaleX(1); }
        }

        .game-title {
            font-family: 'Old Standard', serif;
            font-size: 4rem;
            font-weight: 700;
            color: #B8860B;
            text-shadow: 0 0 20px rgba(184, 134, 11, 0.6);
            margin: 20px 0;
            letter-spacing: 3px;
            position: relative;
            animation: titleShimmer 3s ease-in-out infinite;
        }

        @keyframes titleShimmer {
            0%, 100% { text-shadow: 0 0 20px rgba(184, 134, 11, 0.6); }
            50% { text-shadow: 0 0 30px rgba(184, 134, 11, 1), 0 0 40px rgba(255, 215, 0, 0.8); }
        }

        .subtitle {
            font-size: 1.5rem;
            color: #00FFFF;
            margin-bottom: 40px;
            font-style: italic;
        }

        .name-input {
            background: rgba(75, 0, 130, 0.3);
            border: 2px solid #B8860B;
            border-radius: 10px;
            padding: 15px 20px;
            font-size: 1.1rem;
            color: #F5F5F5;
            width: 300px;
            max-width: 90%;
            margin: 20px 0;
            text-align: center;
            font-family: 'Crimson Text', serif;
            transition: all 0.3s ease;
        }

        .name-input:focus {
            border-color: #00FFFF;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
            outline: none;
        }

        .name-input::placeholder {
            color: rgba(245, 245, 245, 0.6);
        }

        .start-button {
            background: linear-gradient(45deg, #B8860B, #DAA520);
            border: 2px solid #FFD700;
            border-radius: 15px;
            padding: 18px 40px;
            font-size: 1.3rem;
            font-weight: 600;
            color: #0F0F23;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            letter-spacing: 2px;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(184, 134, 11, 0.4);
            animation: buttonPulse 2s ease-in-out infinite;
            position: relative;
            overflow: hidden;
        }

        @keyframes buttonPulse {
            0%, 100% { box-shadow: 0 0 20px rgba(184, 134, 11, 0.4); }
            50% { box-shadow: 0 0 30px rgba(184, 134, 11, 0.8), 0 0 40px rgba(255, 215, 0, 0.6); }
        }

        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 30px rgba(184, 134, 11, 0.6);
            background: linear-gradient(45deg, #DAA520, #FFD700);
        }

        /* Greek border patterns */
        .greek-border {
            border: 3px solid;
            border-image: linear-gradient(45deg, #B8860B, #FFD700, #B8860B) 1;
            position: relative;
        }

        .greek-border::before {
            content: '◆ ◇ ◆ ◇ ◆ ◇ ◆ ◇ ◆ ◇ ◆ ◇ ◆ ◇ ◆';
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            color: #B8860B;
            font-size: 0.9rem;
            letter-spacing: 5px;
            background: #0F0F23;
            padding: 0 10px;
        }

        .greek-border::after {
            content: '◇ ◆ ◇ ◆ ◇ ◆ ◇ ◆ ◇ ◆ ◇ ◆ ◇ ◆ ◇';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            color: #B8860B;
            font-size: 0.9rem;
            letter-spacing: 5px;
            background: #0F0F23;
            padding: 0 10px;
        }

        /* Screen 2: Game */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(75, 0, 130, 0.2);
            border: 1px solid #B8860B;
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .player-name {
            font-size: 1.1rem;
            color: #00FFFF;
        }

        .timer {
            font-size: 1.2rem;
            font-weight: 600;
            color: #B8860B;
            font-family: 'Cinzel', serif;
        }

        .riddle-section {
            background: rgba(26, 26, 58, 0.6);
            border: 2px solid #4B0082;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 0 30px rgba(75, 0, 130, 0.3);
        }

        .riddle-title {
            font-family: 'Batangas', serif;
            font-size: 2rem;
            font-weight: 700;
            color: #B8860B;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(184, 134, 11, 0.6);
            letter-spacing: 2px;
        }

        .riddle-content {
            font-size: 1.3rem;
            line-height: 1.7;
            color: #F5F5F5;
            text-align: justify;
            margin-bottom: 20px;
        }

        .riddle-content p {
            margin-bottom: 15px;
        }

        .clue {
            background: rgba(0, 255, 255, 0.1);
            border-left: 4px solid #00FFFF;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 10px 10px 0;
            font-style: italic;
            text-align: left;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        .demon-selection {
            margin: 30px 0;
        }

        .demon-category {
            margin-bottom: 25px;
            background: rgba(26, 26, 58, 0.4);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(75, 0, 130, 0.5);
        }

        .category-title {
            font-family: 'Old Standard', serif;
            font-size: 1.3rem;
            margin-bottom: 15px;
            text-align: center;
            text-shadow: 0 0 10px currentColor;
        }

        .category-title.wrath { color: #FF0000; }
        .category-title.greed { color: #FFD700; }
        .category-title.gluttony { color: #FF69B4; }
        .category-title.sloth { color: #9370DB; }

        .demon-row {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .demon-button {
            background: rgba(75, 0, 130, 0.3);
            border: 2px solid #4B0082;
            border-radius: 12px;
            padding: 15px;
            color: #F5F5F5;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Old Standard', serif;
            text-align: center;
            min-width: 100px;
            position: relative;
        }

        .demon-button:hover {
            background: rgba(184, 134, 11, 0.2);
            border-color: #B8860B;
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(184, 134, 11, 0.4);
        }

        .demon-button.selected {
            background: rgba(0, 255, 255, 0.2);
            border-color: #00FFFF;
            color: #00FFFF;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }

        .demon-icon {
            font-size: 2rem;
            margin-bottom: 8px;
        }

        .demon-info {
            font-size: 1.1rem;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .submit-button {
            background: linear-gradient(45deg, #FF0000, #FF4500);
            border: none;
            border-radius: 12px;
            padding: 18px 35px;
            font-size: 1.4rem;
            font-weight: 600;
            color: #F5F5F5;
            cursor: pointer;
            font-family: 'Old Standard', serif;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.3);
        }

        .submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 25px rgba(255, 0, 0, 0.5);
        }

        .submit-button:disabled {
            background: rgba(128, 128, 128, 0.5);
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Screen 3: Result */
        .result-section {
            text-align: center;
            padding: 40px 20px;
        }

        .result-title {
            font-family: 'Old Standard', serif;
            font-size: 2.5rem;
            margin-bottom: 30px;
        }

        .result-title.correct {
            color: #00FF00;
            text-shadow: 0 0 20px rgba(0, 255, 0, 0.6);
        }

        .result-title.incorrect {
            color: #FF0000;
            text-shadow: 0 0 20px rgba(255, 0, 0, 0.6);
        }

        .result-message {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 30px;
            color: #F5F5F5;
            text-align: left;
        }

        .play-again-button {
            background: linear-gradient(45deg, #4B0082, #8A2BE2);
            border: none;
            border-radius: 12px;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: 600;
            color: #F5F5F5;
            cursor: pointer;
            font-family: 'Old Standard', serif;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            margin: 10px;
            box-shadow: 0 0 20px rgba(75, 0, 130, 0.3);
        }

        .play-again-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 25px rgba(75, 0, 130, 0.5);
        }

        /* Enhanced Congratulations Pop-up */
        .popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .popup-overlay.active {
            display: flex;
            opacity: 1;
        }

        .popup-content {
            background: linear-gradient(135deg, #1A1A3A 0%, #0F0F23 100%);
            border: 3px solid #B8860B;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            position: relative;
            box-shadow: 0 0 50px rgba(184, 134, 11, 0.6);
            animation: popupAppear 0.5s ease-out;
            transform: scale(0.95);
        }

        @keyframes popupAppear {
            0% {
                opacity: 0;
                transform: scale(0.7) translateY(-50px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .sparkle-border {
            position: relative;
            padding: 20px;
            border: 3px solid #FFD700;
            border-radius: 25px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
        }

        /* Floating sparkles around popup */
        .popup-sparkle {
            position: absolute;
            color: #FFD700;
            font-size: 1.5rem;
            animation: sparkleFloat 3s ease-in-out infinite;
        }

        @keyframes sparkleFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.7; }
            50% { transform: translateY(-20px) rotate(180deg); opacity: 1; }
        }

        .congrats-title {
            font-family: 'Cinzel', serif;
            font-size: 2.5rem;
            font-weight: 700;
            color: #00FFFF;
            text-shadow: 0 0 30px rgba(0, 255, 255, 0.8);
            margin-bottom: 30px;
            letter-spacing: 3px;
            animation: glowPulse 2s ease-in-out infinite alternate;
        }

        @keyframes glowPulse {
            0% { text-shadow: 0 0 30px rgba(0, 255, 255, 0.8); }
            100% { text-shadow: 0 0 50px rgba(0, 255, 255, 1), 0 0 70px rgba(0, 255, 255, 0.6); }
        }

        .hope-image {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            animation: hopeFloat 3s ease-in-out infinite alternate;
        }

        @keyframes hopeFloat {
            0% { transform: translateY(0px); }
            100% { transform: translateY(-10px); }
        }

        .victory-info {
            margin: 30px 0;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .player-victory {
            color: #FFD700;
            font-weight: 600;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }

        .victory-message {
            color: #00FFFF;
            font-weight: 600;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }

        .victory-detail {
            color: #F5F5F5;
            font-style: italic;
            margin-top: 15px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .game-title {
                font-size: 3rem;
            }
            
            .game-header {
                flex-direction: column;
                text-align: center;
            }
            
            .riddle-section {
                padding: 20px;
            }

            .riddle-content {
                font-size: 1.2rem;
            }

            .rune-decoration {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .game-title {
                font-size: 2.5rem;
                letter-spacing: 1px;
            }
            
            .container {
                padding: 10px;
            }

            .popup-content {
                padding: 30px 20px;
                margin: 20px;
            }
            
            .congrats-title {
                font-size: 2rem;
            }
            
            .hope-image {
                width: 150px;
                height: 150px;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><!-- Fog layer -->
  <div class="fog-layer"></div><!-- Floating particles -->
  <div class="particles" id="particles"></div><!-- Rune decorations -->
  <div class="rune-decoration rune-top-left">
   ᚱ
  </div>
  <div class="rune-decoration rune-top-right">
   ᚦ
  </div>
  <div class="rune-decoration rune-bottom-left">
   ᚨ
  </div>
  <div class="rune-decoration rune-bottom-right">
   ᚾ
  </div><!-- Screen 1: Introduction -->
  <div class="screen active" id="introScreen">
   <div class="container">
    <h1 class="game-title" id="gameTitle">The Pandora's Box</h1>
    <p class="subtitle" id="subtitle">Mathletica: Đố vui không thưởng #11</p><!-- Enhanced Pandora's Box SVG -->
    <div class="pandora-box">
     <div class="box-light-rays"></div>
     <svg viewbox="0 0 200 150" xmlns="http://www.w3.org/2000/svg"><!-- Box base --> <rect x="30" y="80" width="140" height="60" fill="#8B4513" stroke="#B8860B" stroke-width="2" /> <!-- Box lid (slightly open) --> <ellipse cx="100" cy="82" rx="75" ry="15" fill="#A0522D" stroke="#B8860B" stroke-width="2" /> <!-- Mystical glow from inside --> <ellipse cx="100" cy="85" rx="60" ry="10" fill="url(#mysticalGlow)" opacity="0.8" /> <!-- Escaping light beams --> <path d="M70 85 L60 70 L80 70 Z" fill="url(#lightBeam)" opacity="0.6">
       <animate attributename="opacity" values="0.3;0.8;0.3" dur="2s" repeatcount="indefinite" />
      </path> <path d="M130 85 L140 70 L120 70 Z" fill="url(#lightBeam)" opacity="0.6">
       <animate attributename="opacity" values="0.8;0.3;0.8" dur="2s" repeatcount="indefinite" />
      </path> <!-- Ancient symbols --> <text x="100" y="115" text-anchor="middle" fill="#B8860B" font-size="16" font-family="serif">
       ⚡ ☽ ⚡
      </text> <!-- Lock --> <rect x="95" y="95" width="10" height="15" fill="#FFD700" stroke="#B8860B" stroke-width="1" /> <circle cx="100" cy="100" r="3" fill="#B8860B" /> <defs>
       <radialgradient id="mysticalGlow" cx="50%" cy="50%" r="50%">
        <stop offset="0%" style="stop-color:#00FFFF;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#4B0082;stop-opacity:0" />
       </radialgradient>
       <lineargradient id="lightBeam" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" style="stop-color:#FFD700;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#FFD700;stop-opacity:0" />
       </lineargradient>
      </defs>
     </svg>
    </div><input type="text" class="name-input" id="playerNameInput" placeholder="Nhập tên của bạn..."> <br><button class="start-button" id="startButton">MỞ HỘP</button>
   </div>
  </div><!-- Screen 2: Game -->
  <div class="screen" id="gameScreen">
   <div class="container">
    <div class="game-header fade-in-content">
     <div class="player-name">
      Người chơi: <span id="displayPlayerName">Khách</span>
     </div>
     <div class="timer" id="gameTimer">
      00:00
     </div>
    </div>
    <div class="riddle-section greek-border fade-in-content delay-1">
     <h2 class="riddle-title" id="riddleTitle">CÂU ĐỐ CỦA PANDORA</h2>
     <div class="riddle-content" id="riddleContent">
      <p><strong>Bối cảnh:</strong> Pandora đang trải qua một ngày tồi tệ chưa từng thấy.</p>
      <p>Cô ấy vốn không hề có ý định mở chiếc hộp . Thực tế, cô đã dùng từng chút ý chí cuối cùng của mình để kháng cự lại nó. Nhưng rồi, sự tò mò đã chiến thắng.</p>
      <p>Một đoàn quân quỷ dữ, tai ương và bệnh tật đủ mọi hình thù đã ào ạt tràn ra ngoài.</p>
      <p>Khi Pandora hoảng hốt sập mạnh cửa trước của căn nhà mình lại, bên trong vẫn còn kẹt lại <strong>10 con tiểu quỷ </strong> và <strong>3 con quỷ lớn </strong>.</p>
      <p>Mười con tiểu quỷ này thuộc 4 loại khác nhau: <span style="color: #FF0000;">Giận Dữ (Wrath)</span>, <span style="color: #FFD700;">Tham Lam (Greed)</span>, <span style="color: #FF69B4;">Phàm Ăn (Gluttony)</span>, <span style="color: #9370DB;">Lười Biếng (Sloth)</span>.</p>
      <p>Con quỷ lớn đầu tiên quay sang Pandora và nói: <em>"Hy Vọng (Hope)... Hy Vọng vẫn còn ở đây. Ta vừa biến cô ấy trông giống hệt một trong 10 con tiểu quỷ kia."</em></p>
      <p>Hắn thì thầm: <em>"Ta vừa nói cho Abaden (Quỷ A) biết Hy Vọng thuộc Loại nào. Và ta đã nói cho Beelzebub (Quỷ B) biết cô ấy có bao nhiêu con mắt."</em></p>
     </div>
     <div class="clue"><strong>Cuộc đối thoại then chốt:</strong><br><strong>Abaden:</strong> "Ta biết chắc chắn rằng ngươi không biết Hy Vọng là ai."<br><strong>Beelzebub:</strong> "À, ban đầu ta không biết, nhưng bây giờ thì ta biết rồi."<br><strong>Abaden:</strong> "Thế thì bây giờ ta cũng biết cô ấy là ai rồi."
     </div>
     <div class="clue"><strong>🎯 Nhiệm vụ:</strong> Tìm ra chính xác con tiểu quỷ nào là Hy Vọng đang ngụy trang!
     </div>
     <div class="clue"><strong>📊 Thông tin:</strong> Abaden chỉ biết LOẠI, Beelzebub chỉ biết SỐ MẮT. Từ cuộc đối thoại, hãy suy luận logic để tìm ra đáp án duy nhất!
     </div>
    </div>
    <div class="demon-selection fade-in-content delay-2">
     <h1 style="text-align: center; color: #B8860B; font-family: 'Old Standard', serif; margin-bottom: 30px;">Hãy chọn con tiểu quỷ mà bạn tin là HY VỌNG:</h1><!-- Wrath Demons -->
     <div class="demon-category">
      <h4 class="category-title wrath">🔥 GIẬN DỮ (Wrath)</h4>
      <div class="demon-row"><button class="demon-button" data-type="Wrath" data-eyes="1">
        <div class="demon-icon">
         👹
        </div>
        <div class="demon-info">
         1 MẮT
        </div></button> <button class="demon-button" data-type="Wrath" data-eyes="2">
        <div class="demon-icon">
         👹
        </div>
        <div class="demon-info">
         2 MẮT
        </div></button>
      </div>
     </div><!-- Greed Demons -->
     <div class="demon-category">
      <h4 class="category-title greed">💰 THAM LAM (Greed)</h4>
      <div class="demon-row"><button class="demon-button" data-type="Greed" data-eyes="2">
        <div class="demon-icon">
         👺
        </div>
        <div class="demon-info">
         2 MẮT
        </div></button> <button class="demon-button" data-type="Greed" data-eyes="5">
        <div class="demon-icon">
         👺
        </div>
        <div class="demon-info">
         5 MẮT
        </div></button>
      </div>
     </div><!-- Gluttony Demons -->
     <div class="demon-category">
      <h4 class="category-title gluttony">🍖 PHÀM ĂN (Gluttony)</h4>
      <div class="demon-row"><button class="demon-button" data-type="Gluttony" data-eyes="1">
        <div class="demon-icon">
         👿
        </div>
        <div class="demon-info">
         1 MẮT
        </div></button> <button class="demon-button" data-type="Gluttony" data-eyes="4">
        <div class="demon-icon">
         👿
        </div>
        <div class="demon-info">
         4 MẮT
        </div></button> <button class="demon-button" data-type="Gluttony" data-eyes="6">
        <div class="demon-icon">
         👿
        </div>
        <div class="demon-info">
         6 MẮT
        </div></button>
      </div>
     </div><!-- Sloth Demons -->
     <div class="demon-category">
      <h4 class="category-title sloth">😴 LƯỜI BIẾNG (Sloth)</h4>
      <div class="demon-row"><button class="demon-button" data-type="Sloth" data-eyes="3">
        <div class="demon-icon">
         😈
        </div>
        <div class="demon-info">
         3 MẮT
        </div></button> <button class="demon-button" data-type="Sloth" data-eyes="4">
        <div class="demon-icon">
         😈
        </div>
        <div class="demon-info">
         4 MẮT
        </div></button> <button class="demon-button correct-answer" data-type="Sloth" data-eyes="6">
        <div class="demon-icon">
         😈
        </div>
        <div class="demon-info">
         6 MẮT
        </div></button>
      </div>
     </div>
    </div><button class="submit-button fade-in-content delay-3" id="submitAnswer" disabled>GỬI ĐÁP ÁN</button>
   </div>
  </div><!-- Screen 3: Result -->
  <div class="screen" id="resultScreen">
   <div class="container">
    <div class="result-section">
     <h2 class="result-title" id="resultTitle">Kết quả</h2>
     <div class="result-message" id="resultMessage"></div><button class="play-again-button" id="playAgainButton">CHƠI LẠI</button> <button class="play-again-button" id="backToMenuButton">VỀ MENU</button>
    </div>
   </div>
  </div><!-- Enhanced Congratulations Pop-up -->
  <div class="popup-overlay" id="congratsPopup">
   <div class="popup-content"><!-- Floating sparkles -->
    <div class="popup-sparkle" style="top: 10%; left: 10%; animation-delay: 0s;">
     ✨
    </div>
    <div class="popup-sparkle" style="top: 15%; right: 15%; animation-delay: 1s;">
     ⭐
    </div>
    <div class="popup-sparkle" style="bottom: 20%; left: 20%; animation-delay: 2s;">
     ✨
    </div>
    <div class="popup-sparkle" style="bottom: 15%; right: 10%; animation-delay: 0.5s;">
     ⭐
    </div>
    <div class="sparkle-border">
     <h2 class="congrats-title">CHÚC MỪNG!</h2><!-- Enhanced Hope Liberation Image -->
     <div class="hope-image">
      <svg viewbox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"><!-- Hope figure --> <circle cx="100" cy="80" r="25" fill="#FFD700" stroke="#00FFFF" stroke-width="2" /> <ellipse cx="100" cy="120" rx="20" ry="40" fill="#FFFFFF" stroke="#00FFFF" stroke-width="2" /> <!-- Wings --> <ellipse cx="75" cy="100" rx="15" ry="25" fill="rgba(0,255,255,0.6)" transform="rotate(-20 75 100)" /> <ellipse cx="125" cy="100" rx="15" ry="25" fill="rgba(0,255,255,0.6)" transform="rotate(20 125 100)" /> <!-- Glow effect --> <circle cx="100" cy="100" r="60" fill="url(#hopeGlow)" opacity="0.4" /> <!-- Animated sparkles around --> <text x="60" y="60" fill="#FFD700" font-size="12">
        ✨ 
        <animate attributename="opacity" values="0.5;1;0.5" dur="1.5s" repeatcount="indefinite" />
       </text> <text x="140" y="70" fill="#FFD700" font-size="10">
        ⭐ 
        <animate attributename="opacity" values="1;0.5;1" dur="2s" repeatcount="indefinite" />
       </text> <text x="70" y="150" fill="#FFD700" font-size="8">
        ✨ 
        <animate attributename="opacity" values="0.7;1;0.7" dur="1.8s" repeatcount="indefinite" />
       </text> <text x="130" y="140" fill="#FFD700" font-size="12">
        ⭐ 
        <animate attributename="opacity" values="0.5;1;0.5" dur="1.3s" repeatcount="indefinite" />
       </text> <defs>
        <radialgradient id="hopeGlow" cx="50%" cy="50%" r="50%">
         <stop offset="0%" style="stop-color:#00FFFF;stop-opacity:0.8" />
         <stop offset="100%" style="stop-color:#FFD700;stop-opacity:0" />
        </radialgradient>
       </defs>
      </svg>
     </div>
     <div class="victory-info">
      <p class="player-victory">Người chơi: <span id="victoryPlayerName">Khách</span></p>
      <p class="victory-message">Bạn đã tìm thấy Hy Vọng trong: <span id="victoryTime">00:00</span></p>
      <p class="victory-detail">Hy Vọng đã được giải thoát khỏi hình dạng <strong>LƯỜI BIẾNG 6 MẮT</strong>!</p>
     </div><button class="play-again-button" id="popupPlayAgain">CHƠI LẠI</button>
    </div>
   </div>
  </div>
  <script>
        // Configuration object for Element SDK
        const defaultConfig = {
            game_title: "The Pandora's Box",
            subtitle: "Mathletica: Đố vui không thưởng #11",
            start_button_text: "MỞ HỘP",
            riddle_title: "CÂU ĐỐ CỦA PANDORA",
            riddle_content: "Bối cảnh: Pandora đang trải qua một ngày tồi tệ chưa từng thấy..."
        };

        // Game state
        let gameState = {
            currentScreen: 'intro',
            playerName: '',
            selectedChoice: null,
            startTime: null,
            correctAnswer: 'Sloth-6',
            selectedType: null,
            selectedEyes: null
        };

        // Timer functionality
        let timerInterval;

        function startTimer() {
            gameState.startTime = Date.now();
            timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - gameState.startTime) / 1000);
                const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
                const seconds = (elapsed % 60).toString().padStart(2, '0');
                document.getElementById('gameTimer').textContent = `${minutes}:${seconds}`;
            }, 1000);
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
        }

        // Enhanced screen navigation with fade effects
        function showScreen(screenName) {
            const currentScreen = document.querySelector('.screen.active');
            const targetScreen = document.getElementById(screenName + 'Screen');
            
            if (currentScreen) {
                currentScreen.classList.add('fade-out');
                setTimeout(() => {
                    currentScreen.classList.remove('active', 'fade-out');
                    if (targetScreen) {
                        targetScreen.classList.add('active');
                        gameState.currentScreen = screenName;
                        
                        // Trigger content animations for game screen
                        if (screenName === 'game') {
                            setTimeout(() => {
                                const fadeElements = targetScreen.querySelectorAll('.fade-in-content');
                                fadeElements.forEach(el => {
                                    el.style.animation = 'contentFadeIn 0.8s ease-out forwards';
                                });
                            }, 100);
                        }
                    }
                }, 500);
            } else if (targetScreen) {
                targetScreen.classList.add('active');
                gameState.currentScreen = screenName;
            }
        }

        // Create floating particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 15;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Game logic
        function startGame() {
            const nameInput = document.getElementById('playerNameInput');
            gameState.playerName = nameInput.value.trim() || 'Khách';
            
            document.getElementById('displayPlayerName').textContent = gameState.playerName;
            showScreen('game');
            startTimer();
        }

        function selectDemon(type, eyes, buttonElement) {
            // Remove previous selection
            document.querySelectorAll('.demon-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // Add selection to clicked button
            buttonElement.classList.add('selected');
            gameState.selectedType = type;
            gameState.selectedEyes = eyes;
            gameState.selectedChoice = `${type}-${eyes}`;
            
            // Enable submit button
            document.getElementById('submitAnswer').disabled = false;
        }

        function submitAnswer() {
            stopTimer();
            
            const isCorrect = gameState.selectedChoice === gameState.correctAnswer;
            const currentTime = document.getElementById('gameTimer').textContent;
            
            if (isCorrect) {
                // Show congratulations popup with enhanced effects
                showCongratsPopup(currentTime);
            } else {
                // Show regular result screen for wrong answers
                const resultTitle = document.getElementById('resultTitle');
                const resultMessage = document.getElementById('resultMessage');
                
                resultTitle.textContent = '❌ SAI RỒI! ❌';
                resultTitle.className = 'result-title incorrect';
                resultMessage.innerHTML = `
                    <p>Rất tiếc! Bạn đã chọn sai con quỷ.</p>
                    <p>Bạn đã chọn: <strong>${gameState.selectedType} ${gameState.selectedEyes} mắt</strong></p>
                    <p>Hãy thử lại để tìm ra con quỷ đúng thông qua logic suy luận!</p>
                    <p>Thời gian chơi: ${currentTime}</p>
                `;
                showScreen('result');
            }
        }

        function showCongratsPopup(completionTime) {
            // Update popup content
            document.getElementById('victoryPlayerName').textContent = gameState.playerName;
            document.getElementById('victoryTime').textContent = completionTime;
            
            // Show popup overlay with fade effect
            const popup = document.getElementById('congratsPopup');
            popup.classList.add('active');
        }

        function hideCongratsPopup() {
            document.getElementById('congratsPopup').classList.remove('active');
        }

        function resetGame() {
            gameState.selectedChoice = null;
            gameState.selectedType = null;
            gameState.selectedEyes = null;
            gameState.startTime = null;
            stopTimer();
            
            // Reset UI
            document.querySelectorAll('.demon-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.getElementById('submitAnswer').disabled = true;
            document.getElementById('gameTimer').textContent = '00:00';
            
            // Reset fade-in animations
            document.querySelectorAll('.fade-in-content').forEach(el => {
                el.style.animation = '';
            });
        }

        // Event listeners
        document.getElementById('startButton').addEventListener('click', startGame);
        document.getElementById('submitAnswer').addEventListener('click', submitAnswer);
        document.getElementById('playAgainButton').addEventListener('click', () => {
            resetGame();
            showScreen('game');
            setTimeout(() => {
                startTimer();
            }, 600); // Wait for screen transition to complete
        });
        document.getElementById('backToMenuButton').addEventListener('click', () => {
            resetGame();
            showScreen('intro');
        });
        document.getElementById('popupPlayAgain').addEventListener('click', () => {
            hideCongratsPopup();
            resetGame();
            showScreen('intro');
        });

        // Demon button event listeners
        document.querySelectorAll('.demon-button').forEach(button => {
            button.addEventListener('click', (e) => {
                const type = e.currentTarget.dataset.type;
                const eyes = e.currentTarget.dataset.eyes;
                selectDemon(type, eyes, e.currentTarget);
            });
        });

        // Enter key support for name input
        document.getElementById('playerNameInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                startGame();
            }
        });

        // Initialize particles on page load
        document.addEventListener('DOMContentLoaded', () => {
            createParticles();
        });

        // Element SDK implementation
        async function onConfigChange(config) {
            // Update game title
            const titleElement = document.getElementById('gameTitle');
            if (titleElement) {
                titleElement.textContent = config.game_title || defaultConfig.game_title;
            }

            // Update subtitle
            const subtitleElement = document.getElementById('subtitle');
            if (subtitleElement) {
                subtitleElement.textContent = config.subtitle || defaultConfig.subtitle;
            }

            // Update start button text
            const startButtonElement = document.getElementById('startButton');
            if (startButtonElement) {
                startButtonElement.textContent = config.start_button_text || defaultConfig.start_button_text;
            }

            // Update riddle title
            const riddleTitleElement = document.getElementById('riddleTitle');
            if (riddleTitleElement) {
                riddleTitleElement.textContent = config.riddle_title || defaultConfig.riddle_title;
            }
        }

        // Initialize Element SDK
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig: defaultConfig,
                onConfigChange: onConfigChange,
                mapToCapabilities: (config) => ({
                    recolorables: [
                        {
                            get: () => config.background_color || "#0F0F23",
                            set: (value) => {
                                config.background_color = value;
                                window.elementSdk.setConfig({ background_color: value });
                            }
                        },
                        {
                            get: () => config.primary_color || "#B8860B",
                            set: (value) => {
                                config.primary_color = value;
                                window.elementSdk.setConfig({ primary_color: value });
                            }
                        },
                        {
                            get: () => config.accent_color || "#00FFFF",
                            set: (value) => {
                                config.accent_color = value;
                                window.elementSdk.setConfig({ accent_color: value });
                            }
                        },
                        {
                            get: () => config.text_color || "#F5F5F5",
                            set: (value) => {
                                config.text_color = value;
                                window.elementSdk.setConfig({ text_color: value });
                            }
                        },
                        {
                            get: () => config.button_color || "#4B0082",
                            set: (value) => {
                                config.button_color = value;
                                window.elementSdk.setConfig({ button_color: value });
                            }
                        }
                    ],
                    borderables: [],
                    fontEditable: {
                        get: () => config.font_family || "Crimson Text",
                        set: (value) => {
                            config.font_family = value;
                            window.elementSdk.setConfig({ font_family: value });
                        }
                    },
                    fontSizeable: {
                        get: () => config.font_size || 16,
                        set: (value) => {
                            config.font_size = value;
                            window.elementSdk.setConfig({ font_size: value });
                        }
                    }
                }),
                mapToEditPanelValues: (config) => new Map([
                    ["game_title", config.game_title || defaultConfig.game_title],
                    ["subtitle", config.subtitle || defaultConfig.subtitle],
                    ["start_button_text", config.start_button_text || defaultConfig.start_button_text],
                    ["riddle_title", config.riddle_title || defaultConfig.riddle_title],
                    ["riddle_content", config.riddle_content || defaultConfig.riddle_content]
                ])
            });
        }
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'993af2b007d2efdf',t:'MTc2MTMyNDM2My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>